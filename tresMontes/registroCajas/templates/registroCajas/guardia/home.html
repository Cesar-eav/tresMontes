{% extends '../base.html' %}
{% block title %}Panel Guardia{% endblock %}
{% block content %}
<div class="header"><h2>Panel de Guardia</h2></div>
<div class="content">
    {% if campana_activa %}
    <div class="card">
        <div class="card-header"><i class="bi bi-calendar-check me-2"></i> Carga Activa</div>
        <div class="card-body">
            <h5>{{ campana_activa.nombre }}</h5>
            <p class="text-muted small mb-2">{{ campana_activa.fecha_inicio|date:"d/m/Y" }} - {{ campana_activa.fecha_fin|date:"d/m/Y" }}</p>
            <div class="stats-container">
                <div class="stat-card"><div class="stat-number">{{ total_entregados }}</div><div class="stat-label">Entregados</div></div>
                <div class="stat-card"><div class="stat-number">{{ total_pendientes }}</div><div class="stat-label">Pendientes</div></div>
            </div>
        </div>
    </div>
    <div class="card">
        <div class="card-header"><i class="bi bi-search me-2"></i> Buscar Beneficiario</div>
        <div class="card-body">
            <form method="GET" action="{% url 'guardia_buscar_rut' %}">
                <div class="form-group"><input type="text" id="rut_home_guardia" name="rut" class="form-control" placeholder="Ingrese RUT (ej: 12.345.678-9)" required></div>
                <button type="submit" class="btn btn-primary w-100"><i class="bi bi-search me-2"></i> Buscar</button>
            </form>
        </div>
    </div>
    <div class="card">
        <div class="card-header"><i class="bi bi-qr-code-scan me-2"></i> Escanear QR</div>
        <div class="card-body">
            <a href="{% url 'guardia_scanner' %}" class="btn btn-success w-100"><i class="bi bi-camera me-2"></i> Abrir Esc√°ner</a>
        </div>
    </div>
    {% else %}
    <div class="alert alert-info"><i class="bi bi-info-circle me-2"></i> No hay carga activa en este momento.</div>
    {% endif %}
</div>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        vincularFormateadorRUT('rut_home_guardia');
    });
</script>
{% endblock %}

{% block footer %}
<div class="footer">
    <a href="{% url 'guardia_home' %}" class="nav-item active"><i class="bi bi-speedometer2"></i><span>Panel</span></a>
    <a href="{% url 'lista_diaria' %}" class="nav-item"><i class="bi bi-list-ul"></i><span>Lista</span></a>
    <a href="{% url 'perfil' %}" class="nav-item"><i class="bi bi-person-circle"></i><span>Perfil</span></a>
</div>
{% endblock %}
